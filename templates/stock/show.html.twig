{% extends 'base.html.twig' %}

{% block title %}StockItem{% endblock %}

{% block body %}
    <div class="container">
        <div class="row">
            <div class="col-12">
                <h1>{{stock_item}}</h1>
                <p>Stock Item details</p>
            </div>
            <div class="col-md-8">
                <table class="table table-success table-sm small table-striped table-hover">
                    <tbody>
                        <tr>
                            <th>{{"Id"|humanize}}</th>
                            <td>{{ stock_item.id }}</td>
                        </tr>
                        <tr>
                            <th>{{"Name"|humanize}}</th>
                            <td>{{ stock_item.name }}</td>
                        </tr>
                        <tr>
                            <th>{{"Quantity"|humanize}}</th>
                            <td>{{ stock_item.quantity }}</td>
                        </tr>
                        <tr>
                            <th>{{"DateIn"|humanize}}</th>
                            <td>{{ stock_item.dateIn ? stock_item.dateIn|date('Y-m-d') : '' }}</td>
                        </tr>
                        <tr>
                            <th>{{"DateOut"|humanize}}</th>
                            <td>{{ stock_item.dateOut ? stock_item.dateOut|date('Y-m-d') : '' }}</td>
                        </tr>
                        <tr>
                            <th>{{"Cost"|humanize}}</th>
                            <td>{{ stock_item.cost }}</td>
                        </tr>
                        <tr>
                            <th>{{"SellingPrice"|humanize}}</th>
                            <td>{{ stock_item.sellingPrice }}</td>
                        </tr>
                        <tr>
                            <th>{{"Revenue"|humanize}}</th>
                            <td>{{ stock_item.revenue }}</td>
                        </tr>
                        <tr>
                            <th>{{"CreditedAmount"|humanize}}</th>
                            <td>{{ stock_item.creditedAmount }}</td>
                        </tr>
                        <tr>
                            <th>{{"DebitedAmount"|humanize}}</th>
                            <td>{{ stock_item.debitedAmount }}</td>
                        </tr>
                        <tr>
                            <th>{{"SoldOut"|humanize}}</th>
                            <td>{{ stock_item.soldOut ? 'Yes' : 'No' }}</td>
                        </tr>
                    </tbody>
                </table>
            </div>
            <div class="col-md-4">
                <div class="card border-dark">
                    <div class="card-body">
                        <h4 class="card-title">Daily Sales Records</h4>
                        <div class="card-text">
                            <div class="list-group list-group-flush small">
                                <div class="list-group-item bg-success text-light">Date <span class="float-right">Amount (Qty)</span></div>
                                {% set totalSales = 0 %}
                                {% set totalStocks = 0 %}
                                {% for sales in stock_item.dailySales %}
                                    {% set totalSales = totalSales + sales.amount %}
                                    {% set totalStocks = totalStocks + sales.quantity %}
                                    <div class="list-group-item">{{sales.date|date('d M')}} <span class="float-right">K {{sales.amount|number_format(2, '.', ',')}} ({{sales.quantity}})</span></div>
                                {% endfor %}
                                <div class="list-group-item bg-warning text-dark"><strong>Total</strong><span class="float-right">K {{ totalSales }} ({{totalStocks}})</span></div>
                                <div class="list-group-item text-muted">Expected <span class="float-right"><em>K {{totalStocks*stock_item.sellingPrice|number_format(2,'.',',')}}</em></span></div>
                                <div class="list-group-item text-muted">Difference <span class="float-right"><em>K {{(totalStocks*stock_item.sellingPrice - totalSales)|number_format(2,'.',',')}}</em></span></div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <a class="btn btn-secondary" href="{{ path('stock_index') }}">back to list</a>
    </div>
{% endblock %}
